Beardy website
=========

*2016/01 - Development in progress*

## General information

- in progress website : https://beardy-website.herokuapp.com/

## App creation

You need to have npm installed

```
$ npm install express-generator -g
$ express beardy-website --git -c sass
```

Then install dependencies:

```
$ cd beardy-website
$ npm install
```

and init repo

```
$ git init
$ git add .
$ git commit -m"whatever"
```

 run the app in `localhost:3000` with this command:

```
$ DEBUG=beardy-website:* npm start
```

When using config.js :
```
$ node app.js dev // ou 'staging', 'production'
```


To install and save in package.json (`-S` = `--save`)
```
npm install -S warehouse
```

## Database

Check mongo status
```
$ service mongod status
```

When you first store data in the database, such as by creating a collection, MongoDB creates the database. For example, the following creates both the database `beardyWebsite` and the collection `organizations` during the insert() operation:

```
$ mongo \\ connect to mongo shell
> show dbs \\ list all dbs
> use beardyWebsite
> db.organizations.insert( { name: "Lyon BD Festival",  website_url: "http://www.lyonbd.com/", beardy_date: "Friday, June 14, 2013"} );
> db.organizations.find().pretty()
```

## Seed data

To populate your db with data in your `seeds` folder, just run `$ seed`.
cf https://www.npmjs.com/package/node-mongo-seeds


## Deploying to heroku

Add file Procfile, containing `web: npm start`

Add heroku support

```
$ heroku create beardy-website
```

and push

```
$ git push heroku master
```

Ensure that at least one instance of the app is running:
```
$ heroku ps:scale web=1
```

Now visit the app at the URL generated by its app name. As a handy shortcut, you can open the website as follows:
```
$ heroku open
```

to view logs
```
heroku logs --tail
```
You can check how many dynos are running using the ps command: `$ heroku ps`
You can also run your app locally via `$ heroku local web`

To start a console : `$ heroku run node`
To connect to heroku server : `$ heroku run bash`
To exit bash : `$ exit`


Config vars :
heroku local will automatically set up the environment based on the contents of the .env file in your local directory. Create a .env file that has the following contents: `TIMES=2`
To set the config var on Heroku, execute the following:
$ heroku config:set TIMES=2
View the config vars that are set using heroku config:
$ heroku config

hide config vars : http://stackoverflow.com/questions/18597510/connect-to-the-database-in-a-heroku-node-js-app-without-revealing-authentication


## Tests

To run tests :
```
$ jasmine-node ./tests
```


## Resoures

### Json DB
- https://github.com/typicode/lowdb

### Basic app with express
- http://zellwk.com/blog/crud-express-and-mongodb-2
- http://code.tutsplus.com/tutorials/build-a-complete-mvc-website-with-expressjs--net-34168

### Creating node app with API
- http://blog.modulus.io/build-your-first-http-server-in-nodejs
- http://cwbuecheler.com/web/tutorials/2014/restful-web-app-node-express-mongodb/
- https://scotch.io/tutorials/build-a-restful-api-using-node-and-express-4
- https://erichonorez.wordpress.com/2013/02/10/how-create-a-rest-api-with-node-js-and-express/

### Hosting nodejs - mongoDb
- https://thomasbandt.com/hosting-nodejs-and-mongodb
- http://www.hostingadvice.com/blog/where-to-find-free-node-js-hosting/
- https://scotch.io/tutorials/use-mongodb-with-a-node-application-on-heroku
- http://givemethechills.com/how-to-migrate-a-node-js-app-from-heroku-to-openshift/
- http://blog.mongolab.com/2015/02/fully-managed-dedicated-mongodb-plans-on-heroku/

### Cleaning app
- https://www.terlici.com/2014/08/25/best-practices-express-structure.html


### Todo

- mongo db connection
- serialize api data
- find url helper
- styling with bootstrap ?

### if continuing project
- basic authentication
- form to add events


### Todo tuto :
- npm install -g jasmine-node
- check config file / /wwww node script : how to mix both ? What to use ?